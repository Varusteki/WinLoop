<Window x:Class="WinLoop.UI.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WinLoop.UI"
    Title="WinLoop设置" Width="680" Height="620" MinWidth="600" MinHeight="500" FontSize="14" FontFamily="Microsoft YaHei" Background="#FFF7F7F7"
        ResizeMode="CanResize" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="Margin" Value="8,6,8,6"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="#FF444444"/>
        </Style>
        <Style x:Key="InputStyle" TargetType="TextBox">
            <Setter Property="Margin" Value="6,6"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="6,0"/>
        </Style>
        <Style x:Key="ComboStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="6,6"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>
        <Style x:Key="GroupBorder" TargetType="Border">
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderBrush" Value="#FFE3E3E3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="#FFFFFFFF"/>
            <Setter Property="Padding" Value="14"/>
            <Setter Property="Margin" Value="6"/>
        </Style>

        <!-- Tab 样式 -->
        <Style x:Key="SettingsTabItem" TargetType="TabItem">
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Background" Value="#FFF7F7F7"/>
            <Setter Property="BorderBrush" Value="#FFE3E3E3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Foreground" Value="#FF444444"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#FFFFFFFF"/>
                    <Setter Property="BorderBrush" Value="#FFD0D0D0"/>
                    <Setter Property="Foreground" Value="#FF222222"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFFAFAFA"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SettingsTabControl" TargetType="TabControl">
            <Setter Property="Background" Value="#FFFFFFFF"/>
            <Setter Property="BorderBrush" Value="#FFE3E3E3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="0"/>
        </Style>

        <!-- 主操作按钮样式 -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="#FF0078D7"/>
            <Setter Property="BorderBrush" Value="#FF0078D7"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,7"/>
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="Foreground" Value="#FFFFFFFF"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF005A9E"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#FF004578"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- 次要操作按钮样式 -->
        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,7"/>
            <Setter Property="MinHeight" Value="32"/>
            <Setter Property="Foreground" Value="#FF444444"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F5F5F5"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#E8E8E8"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- 小按钮样式（颜色选择器） -->
        <Style x:Key="SmallButton" TargetType="Button">
            <Setter Property="Background" Value="#FFF0F0F0"/>
            <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="Normal"/>
        </Style>
    </Window.Resources>
    
    <Grid Grid.IsSharedSizeScope="True">
        <TabControl Name="MainTabControl" Margin="10" Style="{StaticResource SettingsTabControl}" ItemContainerStyle="{StaticResource SettingsTabItem}">
            <!-- 菜单样式设置 -->
            <TabItem Header="菜单样式">
                <Border Padding="20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- 菜单样式选择 -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="菜单样式：" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <RadioButton Name="BasicRadialRadio" Content="圆环" IsChecked="True" Margin="5" VerticalAlignment="Center"/>
                        </StackPanel>
                        
                        <!-- 配置项 -->
                        <Grid Grid.Row="1">
                            <!-- 基础环形菜单配置 -->
                            <Grid Name="BasicRadialConfigGrid">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="外半径:" Style="{StaticResource LabelStyle}"/>
                                <TextBox Grid.Row="0" Grid.Column="1" Name="BasicOuterRadiusBox" Text="50" Style="{StaticResource InputStyle}"/>
                                
                                <TextBlock Grid.Row="0" Grid.Column="3" Text="圆环颜色:" Style="{StaticResource LabelStyle}"/>
                                <StackPanel Grid.Row="0" Grid.Column="4" Orientation="Horizontal">
                                    <TextBox Name="BasicRingColorBox" Text="#FFFFFF" Style="{StaticResource InputStyle}" Width="100"/>
                                    <Button Name="BasicRingColorPickButton" Width="28" Height="26" Margin="4,0,0,0" Content="..." Style="{StaticResource SmallButton}" ToolTip="选择颜色"/>
                                </StackPanel>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="内半径:" Style="{StaticResource LabelStyle}"/>
                                <TextBox Grid.Row="1" Grid.Column="1" Name="BasicInnerRadiusBox" Text="28" Style="{StaticResource InputStyle}"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="3" Text="高亮颜色:" Style="{StaticResource LabelStyle}"/>
                                <StackPanel Grid.Row="1" Grid.Column="4" Orientation="Horizontal">
                                    <TextBox Name="BasicHighlightColorBox" Text="#007AFF" Style="{StaticResource InputStyle}" Width="100"/>
                                    <Button Name="BasicHighlightColorPickButton" Width="28" Height="26" Margin="4,0,0,0" Content="..." Style="{StaticResource SmallButton}" ToolTip="选择颜色"/>
                                </StackPanel>
                            </Grid>

                        </Grid>

                        <!-- 预览区（放在设置项下方，循环高亮展示） -->
                        <Border Grid.Row="2" Margin="0,20,0,0" Style="{StaticResource GroupBorder}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Grid.Row="0" Text="效果预览" Margin="0,0,0,10"/>
                                <Canvas Name="PreviewCanvas" Grid.Row="1" Background="#00000000" MinHeight="250" HorizontalAlignment="Center" VerticalAlignment="Center" Width="300" Height="300"/>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </TabItem>
            
            <!-- 操作配置 -->
            <TabItem Header="操作配置">
                <Grid Margin="20" Name="OpConfigRoot">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="280"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- 左侧：菜单预览区域（垂直居中），点击扇区选择 -->
                    <Border Grid.Column="0" Style="{StaticResource GroupBorder}" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <TextBlock Grid.Row="0" Text="点击扇区选择配置" Foreground="#888" FontSize="12" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                            <Canvas Name="OpPreviewCanvas" Grid.Row="1" Background="#00000000" Width="220" Height="220" MouseLeftButtonDown="OpPreviewCanvas_MouseLeftButtonDown"/>
                        </Grid>
                    </Border>
                    
                    <!-- 右侧：当前选中扇区的配置 -->
                    <Border Grid.Column="1" Style="{StaticResource GroupBorder}" VerticalAlignment="Center" Margin="20,0,0,0">
                        <StackPanel Name="OpSettingsPanel">
                            <TextBlock Name="CurrentPositionLabel" Text="位置1 (上)" FontSize="16" Margin="0,0,0,12"/>
                            <Grid Margin="0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="动作:" VerticalAlignment="Center"/>
                                <ComboBox Grid.Column="1" Name="CurrentPositionCombo" Style="{StaticResource ComboStyle}" Width="180" HorizontalAlignment="Left" SelectionChanged="CurrentPositionCombo_SelectionChanged"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- 悬空寺 -->
            <TabItem Header="悬空寺">
                <Border Padding="20">
                    <StackPanel Margin="10,0,0,0" Width="520">
                        <CheckBox Name="XuanKongSiEnabledCheck" Content="启用" IsChecked="True" Margin="0,6"/>

                        <Grid Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="触发按键:" VerticalAlignment="Center" Style="{StaticResource LabelStyle}"/>
                            <ComboBox Grid.Column="1" Name="XuanKongSiKeyCombo" Style="{StaticResource ComboStyle}" Width="200"/>
                        </Grid>

                        <Grid Margin="0,6,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="展示内容:" VerticalAlignment="Center" Style="{StaticResource LabelStyle}"/>
                            <ComboBox Grid.Column="1" Name="XuanKongSiContentCombo" Style="{StaticResource ComboStyle}" Width="200"/>
                        </Grid>

                        <Grid Margin="0,6,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="140"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="操作提示:" VerticalAlignment="Top" Style="{StaticResource LabelStyle}"/>
                            <TextBlock Grid.Column="1" Name="XuanKongSiOperationHintText" Margin="6,6" Foreground="#666" TextWrapping="Wrap" />
                        </Grid>

                        <!-- 文字 -->
                        <StackPanel Name="XuanKongSiTextPanel" Margin="0,10,0,0" Visibility="Collapsed">
                            <TextBlock Text="文字内容(Markdown):" Margin="0,0,0,6"/>
                            <Border Style="{StaticResource GroupBorder}" Padding="8">
                                <TextBox Name="XuanKongSiTextEditor" Style="{StaticResource InputStyle}" Height="220"
                                         AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" />
                            </Border>
                        </StackPanel>

                        <!-- 图片 -->
                        <StackPanel Name="XuanKongSiImagePanel" Margin="0,10,0,0" Visibility="Visible">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                <Button Name="XuanKongSiPickImageButton" Content="选择图片..." Width="110" Style="{StaticResource SecondaryButton}"/>
                                <TextBlock Name="XuanKongSiImagePathLabel" Text="(默认：小鹤双拼键位图)" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="#666"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- 网页选项已移除 -->
                    </StackPanel>
                </Border>
            </TabItem>
            
            <!-- 杂项设置 -->
            <TabItem Header="杂项设置">
                <Border Padding="20">
                    <StackPanel Margin="20,12,0,0">
                        <CheckBox Name="AutoStartCheck" Content="开机自动启动" IsChecked="True" Margin="0,6"/>
                        <CheckBox Name="MinimizeToTrayCheck" Content="最小化到托盘" IsChecked="True" Margin="0,6"/>
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                            <TextBlock Text="触发时长(毫秒):" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <TextBox Name="TriggerDelayBox" Text="200" Style="{StaticResource InputStyle}" Width="100"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </TabItem>
        </TabControl>
        
        <!-- 操作按钮（右上角） -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="10,10,10,0" Panel.ZIndex="100">
            <Button x:Name="RestoreDefaultsButton" Content="恢复默认" Width="90" Margin="0,0,10,0" Style="{StaticResource SecondaryButton}"/>
            <Button Name="SaveButton" Content="保存" Width="90" Style="{StaticResource PrimaryButton}"/>
        </StackPanel>
    </Grid>
</Window>
